import dotenv from 'dotenv';
dotenv.config();

import { scenario1_PersonalAssistant } from './scenarios/scenario1-personal-assistant.js';
import { scenario2_CustomerService } from './scenarios/scenario2-customer-service.js';
import { scenario3_LongConversationAssistant } from './scenarios/scenario3-long-conversation.js';

/**
 * ä¸Šä¸‹æ–‡è®°å¿†ä¸å¯¹è¯å†å²ç®¡ç† - å®Œæ•´ç¤ºä¾‹
 *
 * æœ¬ç¤ºä¾‹å±•ç¤ºäº†ä¸‰ç§å¸¸ç”¨çš„è®°å¿†ç®¡ç†ç­–ç•¥ï¼š
 * 1. Buffer Memoryï¼ˆç¼“å†²è®°å¿†ï¼‰- ä¿å­˜æ‰€æœ‰å¯¹è¯å†å²
 * 2. Window Memoryï¼ˆçª—å£è®°å¿†ï¼‰- åªä¿ç•™æœ€è¿‘ N è½®å¯¹è¯
 * 3. Summary Memoryï¼ˆæ‘˜è¦è®°å¿†ï¼‰- å®šæœŸç”Ÿæˆæ‘˜è¦å‹ç¼©å†å²
 *
 * æ ¸å¿ƒæ¦‚å¿µï¼š
 * - Memoryï¼ˆå¯¹è¯è®°å¿†ï¼‰- LangChain.js æ ¸å¿ƒæ¦‚å¿µä¹‹ä¸€
 * - Chainsï¼ˆé“¾å¼è°ƒç”¨ï¼‰- å°†è®°å¿†é›†æˆåˆ°å·¥ä½œæµä¸­
 * - Promptsï¼ˆæç¤ºè¯æ¨¡æ¿ï¼‰- åœ¨æç¤ºè¯ä¸­ä½¿ç”¨å†å²å¯¹è¯
 */

/**
 * è®°å¿†ç­–ç•¥å¯¹æ¯”
 */
function compareMemoryStrategies() {
    console.log('\n' + '='.repeat(70));
    console.log('ğŸ“Š ä¸‰ç§è®°å¿†ç­–ç•¥å¯¹æ¯”');
    console.log('='.repeat(70));

    const comparison = `
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç‰¹æ€§         â”‚ Buffer Memory  â”‚ Window Memory  â”‚ Summary Memory â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ä¿¡æ¯å®Œæ•´æ€§   â”‚ â­â­â­â­â­      â”‚ â­â­â­          â”‚ â­â­â­â­        â”‚
â”‚ Token æ•ˆç‡   â”‚ â­â­            â”‚ â­â­â­â­        â”‚ â­â­â­â­â­      â”‚
â”‚ å®ç°å¤æ‚åº¦   â”‚ â­              â”‚ â­â­            â”‚ â­â­â­â­        â”‚
â”‚ é€‚ç”¨å¯¹è¯è½®æ•° â”‚ < 10 è½®        â”‚ 10-50 è½®       â”‚ 50+ è½®         â”‚
â”‚ API è°ƒç”¨æ¬¡æ•° â”‚ ä½             â”‚ ä½             â”‚ é«˜ï¼ˆéœ€ç”Ÿæˆæ‘˜è¦ï¼‰â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ä½¿ç”¨å»ºè®®ï¼š

ğŸ”¹ Buffer Memory (ç¼“å†²è®°å¿†)
   âœ“ ç®€å•çš„é—®ç­”ç³»ç»Ÿ
   âœ“ çŸ­æœŸå’¨è¯¢æœåŠ¡
   âœ“ å¿«é€ŸåŸå‹å¼€å‘
   âœ— ä¸é€‚åˆé•¿æ—¶é—´äº¤äº’

ğŸ”¹ Window Memory (çª—å£è®°å¿†)
   âœ“ å®¢æœæœºå™¨äºº
   âœ“ ä»»åŠ¡åŠ©æ‰‹
   âœ“ å¯¹è¯å¼ç•Œé¢
   âœ— ä¸é€‚åˆéœ€è¦é•¿æœŸè®°å¿†çš„åœºæ™¯

ğŸ”¹ Summary Memory (æ‘˜è¦è®°å¿†)
   âœ“ é•¿æœŸçŸ¥è¯†ç®¡ç†
   âœ“ å¤æ‚ä»»åŠ¡è§„åˆ’
   âœ“ å­¦ä¹ åŠ©æ‰‹
   âœ— éœ€è¦é¢å¤–çš„ API æˆæœ¬

ğŸ’¡ å®é™…åº”ç”¨ä¸­å¯ä»¥ç»„åˆä½¿ç”¨ï¼š
   - è¿‘æœŸç”¨ Window Memory
   - è¿œæœŸç”¨ Summary Memory
   - å…³é”®ä¿¡æ¯ç”¨ç‹¬ç«‹å­˜å‚¨ï¼ˆæ•°æ®åº“ï¼‰
`;

    console.log(comparison);
}

/**
 * ä¸»å‡½æ•°
 */
async function main() {
    console.log('ğŸš€ ä¸Šä¸‹æ–‡è®°å¿†ä¸å¯¹è¯å†å²ç®¡ç† - å®Œæ•´ç¤ºä¾‹');
    console.log('åŸºäº LangChain.js Memory æ¦‚å¿µ\n');

    try {
        // æ˜¾ç¤ºå¯¹æ¯”è¡¨
        compareMemoryStrategies();

        // åœºæ™¯ 1: ä¸ªäººåŠ©æ‰‹ï¼ˆBuffer Memoryï¼‰
        // await scenario1_PersonalAssistant();

        // åœºæ™¯ 2: å®¢æœæœºå™¨äººï¼ˆWindow Memoryï¼‰
        // await scenario2_CustomerService();

        // åœºæ™¯ 3: é•¿å¯¹è¯åŠ©æ‰‹ï¼ˆSummary Memoryï¼‰
        await scenario3_LongConversationAssistant();

        console.log('\n' + '='.repeat(70));
        console.log('ğŸ‰ æ‰€æœ‰åœºæ™¯æ¼”ç¤ºå®Œæˆï¼');
        console.log('='.repeat(70));
        console.log('\næ ¸å¿ƒå­¦ä¹ è¦ç‚¹æ€»ç»“ï¼š\n');
        console.log('1ï¸âƒ£  Memory (è®°å¿†) æ˜¯ LangChain.js çš„æ ¸å¿ƒæ¦‚å¿µä¹‹ä¸€');
        console.log('2ï¸âƒ£  ä¸åŒè®°å¿†ç­–ç•¥é€‚ç”¨äºä¸åŒåœºæ™¯ï¼Œéœ€è¦æ ¹æ®å®é™…éœ€æ±‚é€‰æ‹©');
        console.log('3ï¸âƒ£  è®°å¿†ç®¡ç†ç›´æ¥å½±å“ token æ¶ˆè€—å’Œæˆæœ¬');
        console.log('4ï¸âƒ£  åœ¨ Chains (é“¾å¼è°ƒç”¨) ä¸­ï¼ŒMemory è´Ÿè´£ç»´æŠ¤ä¸Šä¸‹æ–‡');
        console.log('5ï¸âƒ£  åœ¨ Prompts (æç¤ºè¯) ä¸­ï¼Œéœ€è¦åˆç†æ•´åˆå†å²å¯¹è¯');
        console.log('\nğŸ’¡ ä¸‹ä¸€æ­¥å­¦ä¹ å»ºè®®ï¼š');
        console.log('   - äº†è§£ Agentsï¼ˆæ™ºèƒ½ä»£ç†ï¼‰å¦‚ä½•ä½¿ç”¨ Memory');
        console.log('   - å­¦ä¹ å¦‚ä½•å°† Memory æŒä¹…åŒ–åˆ°æ•°æ®åº“');
        console.log(
            '   - æ¢ç´¢æ›´å¤šé«˜çº§è®°å¿†ç­–ç•¥ï¼ˆå¦‚ Entity Memoryã€Knowledge Graph Memoryï¼‰'
        );
    } catch (error) {
        console.error('âŒ æ‰§è¡Œå‡ºé”™:', error.message);
        console.error('è¯·æ£€æŸ¥ï¼š');
        console.error('  1. .env æ–‡ä»¶ä¸­çš„ Dify API é…ç½®æ˜¯å¦æ­£ç¡®');
        console.error('  2. API Key æ˜¯å¦æœ‰æ•ˆ');
        console.error('  3. ç½‘ç»œè¿æ¥æ˜¯å¦æ­£å¸¸');
    }
}

// è¿è¡Œä¸»å‡½æ•°
main().catch(console.error);
