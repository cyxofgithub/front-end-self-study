## SSR、SSG、RSC 原理及优缺点

### SSR（Server Side Rendering，服务端渲染）

**原理**  
SSR 指在服务器端生成页面的 HTML 内容，并将完整的 HTML 返回给浏览器，浏览器拿到 HTML 可以直接渲染，随后再通过 JS 让页面变成可以交互的“水合”模式（Hydration）。典型应用如 Next.js/ Nuxt.js 等。

**优点**

-   首屏加载更快，对 SEO 友好（HTML 已经包含内容，爬虫可直接读取）
-   获取数据与渲染由服务端统一控制，利于数据安全
-   对弱网/低端设备用户体验好

**缺点**

-   服务器压力较大，需频繁渲染，影响高并发场景
-   增加了开发/部署成本
-   某些页面首次加载时间更短，但页面间切换可能不如 CSR 顺畅

---

### SSG（Static Site Generation，静态站点生成）

**原理**  
在构建阶段（Build Time）通过服务端将所有页面预先生成静态 HTML 文件（以及相应的静态资源），请求页面时直接读取静态文件，无需实时计算。代表框架如 Next.js 的 `getStaticProps`，Gatsby，Hugo 等。

**优点**

-   极速首屏渲染，不依赖服务器实时计算
-   服务器压力小，可用 CDN 全量分发，成本低、易扩展
-   高度稳定，不会因服务端崩溃导致全站不可访问

**缺点**

-   页面内容变动需重新构建部署，不适合频繁变化的动态站点
-   构建时间随内容量增大而增加
-   对于需要用户个性化或实时数据的页面不适用

---

### RSC（React Server Components，React 服务器组件）

**原理**  
RSC 是 React 推出的新架构，允许 React 组件在服务端执行，将服务端渲染与客户端渲染无缝结合。通过标记 `.server.js`/`.client.js` 或 `"use client"`，开发者可以选择哪些组件在服务端、哪些在客户端运行。服务端组件不会打包进 JS，不产生前端 JS 体积负担，却可以直接访问数据库等后端资源。

**优点**

-   服务端组件无需打包进前端 bundle，减少 JS 体积
-   可以利用服务端能力（如数据库、文件系统、密钥等），安全高效
-   支持数据流向的灵活切分，重用传统 SSR 和 CSR 的优点
-   更易维护，提升开发体验

**缺点**

-   还在不断完善，配套生态不够成熟
-   部署要求 Node.js 环境和规范的 SSR 基础设施
-   客户端和服务端之间代码管理和调试有一定门槛

---

### RSC 和 SSR 有什么大的区别？

**1. 渲染对象和粒度不同：**

-   **SSR（Server Side Rendering）** 渲染的是完整的页面，对整个路由的 React 组件树进行服务端预渲染，然后发送 HTML 到客户端，再水合（Hydrate）为可交互页面。
-   **RSC（React Server Components）** 可以让「部分组件」（不仅仅是一整个页面）只在服务端运行，不会被打包进客户端 JS。你可以按需决定「哪些组件只在服务端渲染、哪些组件还要在客户端运行」。

**2. 产物不同：**

-   SSR 的产物是 HTML + 必要 JS，「全部组件」最终都要有 JS 代码下发到浏览器，进行水合。
-   RSC 产物是「服务端数据流」+「客户端需交互部分的 JS」，服务端组件不会参与前端 JS bundle——大幅减少前端包体积，降低客户端 JS 执行负担。

**3. 数据请求和服务端能力利用：**

-   SSR：数据请求通常只能发生在页面级「getServerSideProps」「服务端入口函数」等，所有子组件也要被序列化到客户端、参与水合。服务端专属能力不易细粒度利用。
-   RSC：服务端组件里直接访问数据库/密钥/后端依赖，不暴露到客户端。更天然地解耦「前台渲染」和「后台数据获取逻辑」。

**4. 交互方式不同：**

-   SSR 的页面一旦水合，交互逻辑都在客户端执行，后续渲染全靠客户端 JS。
-   RSC 可以「按需」决定哪些组件在客户端、有交互，哪里纯粹服务端渲染（如只展示的静态内容），有更细的渲染粒度控制。

**小结：**

-   SSR 是“整个页面”服务端渲染，所有组件都要能在客户端运行。
-   RSC 可以“部分组件”只在服务端存在/渲染，兼得 SSR/SSG/CSR 各自优势，使大体量项目架构更灵活、性能更优。
-   RSC 本质是 SSR 和 CSR 更进一步的进化和结合。

### 总结对比表

| 模式 | 适合场景                    | 特点                                         | SEO | 首屏速度 | 实时数据 | 服务端压力 |
| ---- | --------------------------- | -------------------------------------------- | :-: | :------: | :------: | :--------: |
| SSR  | 新闻门户、内容频繁变动      | **服务端每次生成**                           | 好  |    快    |    好    |     高     |
| SSG  | 博客、文档、展示型官网      | 构建时生成静态                               | 好  |   极快   |    差    |     低     |
| RSC  | 高交互/大规模应用（如商城） | 粒度细可控制哪些组件在服务端生成哪些在客户端 | 好  | 快~极快  |    好    |   视实现   |
