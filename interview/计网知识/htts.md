## HTTPS

å…¶å® HTTPS å°±æ˜¯æŠ«ç€ SSL å¤–å£³çš„ HTTPï¼Œåœ¨é‡‡ç”¨äº† SSL åï¼ŒHTTP å°±æ‹¥æœ‰äº†åŠ å¯†ã€è¯ä¹¦å’Œå®Œæ•´æ€§ä¿æŠ¤è¿™äº›åŠŸèƒ½ã€‚

**æ€ä¹ˆåŠ å¯†ï¼Ÿ**

ä½¿ç”¨å¯¹ç§°å’Œéå¯¹ç§°åŠ å¯†ç»“åˆçš„æ–¹å¼ã€‚ä¸ºä»€ä¹ˆï¼Ÿ

-   å¯¹ç§°å¯†é’¥å¯†ç ç®—æ³•å¤„ç†è¿…é€Ÿï¼Œä½†æ˜¯éœ€è¦å…±äº«å¯†é’¥ï¼Œè¿™å¾€å¾€éœ€è¦è€—è´¹å·¨å¤§çš„ä»£ä»·
-   å…¬å¼€å¯†é’¥æ— éœ€å…±äº«å¯†é’¥ï¼Œä½†æ˜¯ç®—æ³•å¤„ç†é€Ÿåº¦æ…¢

æ‰€ä»¥å°±é‡‡ç”¨éå¯¹ç§°åŠ å¯†å»å…±äº«å¯†é’¥ï¼Œåç»­å°±é‡‡ç”¨å¯¹ç§°åŠ å¯†çš„æ–¹å¼ã€‚

**å®Œæ•´ä¿æŠ¤**

åœ¨ç°ä»£å¯†ç å­¦ä¸­æœ‰ä¸€ä¸ªå«æ•£åˆ—å‡½æ•°çš„ï¼Œä¹Ÿå°±æ˜¯å“ˆå¸Œå‡½æ•°ï¼Œå®ƒå¯ä»¥å°†å†…å®¹è½¬æ¢æˆä¸€ç³»åˆ—çš„ hashï¼Œå¦‚æœå†…å®¹å‘ç”Ÿäº†å˜åŒ–å®ƒçš„ hash ä¹Ÿä¼šå˜ï¼Œåˆ©ç”¨å®ƒæˆ‘ä»¬å°±å¯ä»¥å®Œæˆå®Œæ•´æ€§ä¿æŠ¤ã€‚

**CA è¯ä¹¦æœ‰ä»€ä¹ˆç”¨ï¼Ÿ**

å®ƒä¸»è¦æ˜¯ä¸ºäº†ç¡®ä¿æœåŠ¡å™¨å…¬é’¥çš„åˆæ³•æ€§ï¼Œå› ä¸ºå…¬é’¥å¾ˆæœ‰å¯èƒ½é€šè¿‡ç¬¬ä¸‰æ–¹ä¼ªé€ ã€‚CA æœºæ„ä¼šç”¨è‡ªå·±çš„ç§é’¥åœ¨è¯ä¹¦ä¸Šå®Œæˆæ•°å­—ç­¾åï¼Œç”¨æˆ·é€šè¿‡å®ƒçš„å…¬é’¥èƒ½æˆåŠŸè§£å¯†å°±è¯´æ˜è¿™ä¸ªè¯ä¹¦æ˜¯å®ƒæ‰€é¢å‘çš„ï¼Œå› ä¸ºç§é’¥æ˜¯å®ƒç‹¬æœ‰çš„ã€‚

### https åŠ å¯†è¿‡ç¨‹

-   å®¢æˆ·ç«¯å…ˆå‘èµ· https è¿æ¥è¯·æ±‚(443 ç«¯å£)
-   æœåŠ¡ç«¯æ”¶åˆ°å®¢æˆ·ç«¯çš„è¯·æ±‚åä¼šè¿”å›è¯ä¹¦ä¿¡æ¯(è¿™ä»½è¯ä¹¦ä¸­åŒ…å«ç€å¯†é’¥ï¼Œå› ä¸ºæœ‰ç€ç¬¬ä¸‰æ–¹æœºæ„çš„æ•°å­—ç­¾åï¼Œå®¢æˆ·ç«¯å¯ä»¥åˆ°ç¬¬ä¸‰æ–¹æœºæ„å»æ£€éªŒè¯ä¹¦çš„åˆæ³•æ€§)
-   å®¢æˆ·ç«¯æ”¶åˆ°å…¬é’¥åä½¿ç”¨å…¬é’¥å¯¹ä¼šè¯å¯†é’¥è¿›è¡ŒåŠ å¯†ï¼Œç„¶åå‘é€ç»™æœåŠ¡ç«¯
-   æœåŠ¡ç«¯æ”¶åˆ°åŠ å¯†ä¿¡æ¯åä½¿ç”¨ç§é’¥è¿›è¡Œè§£å¯†ä¹Ÿå¾—åˆ°ä¼šè¯å¯†é’¥
-   åç»­å°±åˆ©ç”¨è¿™ä¸ªä¼šè¯å¯†é’¥ä»¥å¯¹ç§°åŠ å¯†çš„æ–¹å¼è¿›è¡Œé€šä¿¡

### éƒ¨ç½²

å°†æœåŠ¡è¯·æ±‚ä» HTTP è½¬å˜ä¸º HTTPS æ˜¯ä¸€ä¸ªé‡è¦çš„å®‰å…¨æªæ–½ï¼Œå¯ä»¥ç¡®ä¿æ•°æ®åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­è¢«åŠ å¯†ï¼Œé˜²æ­¢è¢«çªƒå¬å’Œç¯¡æ”¹ã€‚ä»¥ä¸‹æ˜¯å°†æœåŠ¡è¯·æ±‚è½¬å˜ä¸º HTTPS çš„æ­¥éª¤å’Œç¤ºä¾‹ä»£ç ï¼š

#### æ­¥éª¤

1. **è·å– SSL/TLS è¯ä¹¦**ï¼š

    - ä½ éœ€è¦ä»å—ä¿¡ä»»çš„è¯ä¹¦é¢å‘æœºæ„ï¼ˆCAï¼‰è·å–ä¸€ä¸ª SSL/TLS è¯ä¹¦ã€‚å¸¸è§çš„ CA åŒ…æ‹¬ Let's Encryptã€DigiCertã€GlobalSign ç­‰ã€‚
    - ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨è‡ªç­¾åè¯ä¹¦è¿›è¡Œæµ‹è¯•ï¼Œä½†è‡ªç­¾åè¯ä¹¦ä¸ä¼šè¢«æµè§ˆå™¨ä¿¡ä»»ã€‚

2. **é…ç½®æœåŠ¡å™¨**ï¼š

    - å°†è·å–åˆ°çš„è¯ä¹¦å’Œç§é’¥é…ç½®åˆ°ä½ çš„æœåŠ¡å™¨ä¸Šã€‚ä¸åŒçš„æœåŠ¡å™¨æœ‰ä¸åŒçš„é…ç½®æ–¹æ³•ï¼Œä»¥ä¸‹æ˜¯ä¸€äº›å¸¸è§æœåŠ¡å™¨çš„é…ç½®ç¤ºä¾‹ã€‚

3. **é‡å®šå‘ HTTP åˆ° HTTPS**ï¼š
    - é…ç½®æœåŠ¡å™¨å°†æ‰€æœ‰çš„ HTTP è¯·æ±‚é‡å®šå‘åˆ° HTTPSï¼Œä»¥ç¡®ä¿æ‰€æœ‰æµé‡éƒ½é€šè¿‡å®‰å…¨çš„ HTTPS ä¼ è¾“ã€‚

#### ç¤ºä¾‹ä»£ç 

ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸è§æœåŠ¡å™¨çš„ HTTPS é…ç½®ç¤ºä¾‹ï¼š

##### Node.js (ä½¿ç”¨ Express)

å¦‚æœä½ ä½¿ç”¨ Node.js å’Œ Express æ¡†æ¶ï¼Œå¯ä»¥æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤é…ç½® HTTPSï¼š

1. **å®‰è£… `https` æ¨¡å—**ï¼š

    - `https` æ¨¡å—æ˜¯ Node.js å†…ç½®æ¨¡å—ï¼Œæ— éœ€é¢å¤–å®‰è£…ã€‚

2. **åˆ›å»º HTTPS æœåŠ¡å™¨**ï¼š

```javascript
const fs = require('fs');
const https = require('https');
const express = require('express');

const app = express();

// è¯»å– SSL/TLS è¯ä¹¦å’Œç§é’¥
const options = {
    key: fs.readFileSync('path/to/your/private.key'),
    cert: fs.readFileSync('path/to/your/certificate.crt'),
};

// é…ç½®ä¸­é—´ä»¶å’Œè·¯ç”±
app.get('/', (req, res) => {
    res.send('Hello, HTTPS!');
});

// åˆ›å»º HTTPS æœåŠ¡å™¨
https.createServer(options, app).listen(443, () => {
    console.log('HTTPS server is running on port 443');
});

// å¯é€‰ï¼šé‡å®šå‘ HTTP åˆ° HTTPS
const http = require('http');
http.createServer((req, res) => {
    res.writeHead(301, { Location: 'https://' + req.headers['host'] + req.url });
    res.end();
}).listen(80);
```

##### Nginx

å¦‚æœä½ ä½¿ç”¨ Nginx ä½œä¸ºåå‘ä»£ç†æœåŠ¡å™¨ï¼Œå¯ä»¥æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤é…ç½® HTTPSï¼š

1. **å®‰è£… Nginx**ï¼š

    - åœ¨å¤§å¤šæ•° Linux å‘è¡Œç‰ˆä¸Šï¼Œå¯ä»¥ä½¿ç”¨åŒ…ç®¡ç†å™¨å®‰è£… Nginxï¼Œä¾‹å¦‚ `apt-get` æˆ– `yum`ã€‚

2. **é…ç½® Nginx**ï¼š

```nginx
server {
    listen 80;
    server_name yourdomain.com;
    return 301 https://$host$request_uri;  # é‡å®šå‘ HTTP åˆ° HTTPS
}

server {
    listen 443 ssl;
    server_name yourdomain.com;

    ssl_certificate /path/to/your/certificate.crt;
    ssl_certificate_key /path/to/your/private.key;

    location / {
        proxy_pass http://localhost:3000;  # ä»£ç†åˆ°ä½ çš„åº”ç”¨æœåŠ¡å™¨
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }
}
```

#### æ€»ç»“

å°†æœåŠ¡è¯·æ±‚ä» HTTP è½¬å˜ä¸º HTTPS éœ€è¦è·å– SSL/TLS è¯ä¹¦ï¼Œå¹¶å°†å…¶é…ç½®åˆ°ä½ çš„æœåŠ¡å™¨ä¸Šã€‚ä¸åŒçš„æœåŠ¡å™¨æœ‰ä¸åŒçš„é…ç½®æ–¹æ³•ï¼Œä½†åŸºæœ¬æ­¥éª¤éƒ½æ˜¯ç›¸ä¼¼çš„ï¼šè·å–è¯ä¹¦ã€é…ç½®æœåŠ¡å™¨ã€é‡å®šå‘ HTTP åˆ° HTTPSã€‚

é€šè¿‡ä¸Šè¿°æ­¥éª¤ï¼Œä½ å¯ä»¥ç¡®ä¿ä½ çš„æœåŠ¡è¯·æ±‚é€šè¿‡ HTTPS è¿›è¡Œå®‰å…¨ä¼ è¾“ã€‚å¦‚æœä½ æœ‰ä»»ä½•è¿›ä¸€æ­¥çš„é—®é¢˜æˆ–éœ€è¦æ›´å¤šç¤ºä¾‹ï¼Œæ¬¢è¿éšæ—¶æé—®ï¼ğŸ˜Š
