## 钩子函数

在 Vue.js 中，钩子函数（也称为生命周期钩子）是指在组件实例从创建到销毁的整个生命周期中，不同阶段会被调用的函数。通过这些钩子函数，你可以在组件的不同阶段执行特定的代码，比如初始化数据、执行异步请求、清理资源等等。

### Vue.js 生命周期图解

以下是 Vue 生命周期钩子的简要流程图：

1. **创建阶段（Creation）**

    - `beforeCreate`：实例初始化之后，数据观测 (data observer) 和事件配置之前被调用。
    - `created`：实例已经创建完成，完成数据观测 (data observer) 和事件配置，但 DOM 还没有渲染。

2. **挂载阶段（Mounting）**

    - `beforeMount`：在挂载开始之前被调用，相关的 `render` 函数首次被调用。
    - `mounted`：el 被新创建的 vm.\$el 替换，并挂载到实例上之后调用该钩子。

3. **更新阶段（Updating）**

    - `beforeUpdate`：在数据发生变化，重新渲染 DOM 之前调用。此时你可以确认应用状态变化。
    - `updated`：由于数据更改导致的虚拟 DOM 重新渲染和新 DOM 更新之后调用。

4. **销毁阶段（Destruction）**
    - `beforeDestroy`：实例销毁之前调用。在这一步，实例仍然完全可用。
    - `destroyed`：实例销毁后调用。此时，所有的绑定和实例的指令已经解除，所有的子实例也已被销毁。

### 钩子函数详细介绍

#### 创建阶段

1. **beforeCreate**

    ```javascript
    beforeCreate() {
      console.log('beforeCreate');
    }
    ```

    - 在实例初始化之后调用，此时 `data` 和 `methods` 等还未被初始化。

2. **created**
    ```javascript
    created() {
      console.log('created');
    }
    ```
    - 在实例创建完成时调用，此时 `data` 和 `methods` 已经可用，但模板还没有挂载。

#### 挂载阶段

3. **beforeMount**

    ```javascript
    beforeMount() {
      console.log('beforeMount');
    }
    ```

    - 在挂载开始之前调用，此时模板编译已完成，但真实的 DOM 还未插入。

4. **mounted**
    ```javascript
    mounted() {
      console.log('mounted');
    }
    ```
    - 在实例挂载到 DOM 后调用，此时 `vm.$el` 可以访问。通常在这里执行对 DOM 的操作。

#### 更新阶段

5. **beforeUpdate**

    ```javascript
    beforeUpdate() {
      console.log('beforeUpdate');
    }
    ```

    - 在响应式数据更新后，虚拟 DOM 重新渲染前调用。适合在更新时进行一些计算或状态确认。

6. **updated**
    ```javascript
    updated() {
      console.log('updated');
    }
    ```
    - 在组件更新完成并 DOM 重新渲染之后调用。可以在这里操作更新后的 DOM。

#### 销毁阶段

7. **beforeDestroy**

    ```javascript
    beforeDestroy() {
      console.log('beforeDestroy');
    }
    ```

    - 在组件销毁之前调用。此时实例仍然可用，可以进行一些清理工作，例如清除定时器。

8. **destroyed**
    ```javascript
    destroyed() {
      console.log('destroyed');
    }
    ```
    - 在组件销毁之后调用。这个时候实例的所有事件监听器、指令绑定等都已解除。适合进行彻底的清理工作。

### 综合示例

以下是一个使用了所有生命周期钩子的 Vue 组件示例：

```javascript
<template>
  <div>
    <p>{{ message }}</p>
  </div>
</template>

<script>
export default {
  data() {
    return {
      message: 'Hello, world!'
    };
  },
  beforeCreate() {
    console.log('beforeCreate');
  },
  created() {
    console.log('created');
  },
  beforeMount() {
    console.log('beforeMount');
  },
  mounted() {
    console.log('mounted');
  },
  beforeUpdate() {
    console.log('beforeUpdate');
  },
  updated() {
    console.log('updated');
  },
  beforeDestroy() {
    console.log('beforeDestroy');
  },
  destroyed() {
    console.log('destroyed');
  }
}
</script>

<style scoped>
/* Add your styles here */
</style>
```

在控制台中，你将看到每个阶段输出的日志信息，帮助你了解

### vue2 与 vue3 区别

Vue 2 和 Vue 3 的生命周期钩子函数在整体流程上非常相似，但 Vue 3 进行了命名和设计上的一些改动，同时引入了组合式 API（Composition API），提供了更灵活的代码组织方式。因此，虽然许多钩子函数在 Vue 2 和 Vue 3 中仍然存在，但在 Vue 3 中有一些改进和变化。

### Vue 3 生命周期钩子函数

Vue 3 引入了一些新的特性和改进，包括新的生命周期钩子函数命名方案。在 Vue 3 中，生命周期钩子函数的概念依然存在，但增加了对组合式 API 的支持，使得代码组织更加灵活。

#### 选项式 API（Options API）

Vue 3 中的选项式 API 钩子函数几乎与 Vue 2 完全一致：

```javascript
export default {
    data() {
        return {
            message: 'Hello, world!',
        };
    },
    beforeCreate() {
        console.log('beforeCreate');
    },
    created() {
        console.log('created');
    },
    beforeMount() {
        console.log('beforeMount');
    },
    mounted() {
        console.log('mounted');
    },
    beforeUpdate() {
        console.log('beforeUpdate');
    },
    updated() {
        console.log('updated');
    },
    beforeUnmount() {
        // Vue 3 改名
        console.log('beforeUnmount');
    },
    unmounted() {
        // Vue 3 改名
        console.log('unmounted');
    },
};
```

注意在 Vue 3 中，`beforeDestroy` 和 `destroyed` 已经改名为 `beforeUnmount` 和 `unmounted`，以与未来潜在的平台无关实现保持一致。

#### 组合式 API（Composition API）

Vue 3 引入了组合式 API，使得我们可以在功能函数内部使用钩子函数。例如：

```javascript
import { onBeforeMount, onMounted, onBeforeUpdate, onUpdated, onBeforeUnmount, onUnmounted } from 'vue';

export default {
    setup() {
        onBeforeMount(() => {
            console.log('beforeMount');
        });

        onMounted(() => {
            console.log('mounted');
        });

        onBeforeUpdate(() => {
            console.log('beforeUpdate');
        });

        onUpdated(() => {
            console.log('updated');
        });

        onBeforeUnmount(() => {
            console.log('beforeUnmount');
        });

        onUnmounted(() => {
            console.log('unmounted');
        });

        return {
            // 你的数据和方法
        };
    },
};
```

### 总结

-   **Vue 2** 的生命周期钩子函数是：

    -   `beforeCreate`
    -   `created`
    -   `beforeMount`
    -   `mounted`
    -   `beforeUpdate`
    -   `updated`
    -   `beforeDestroy`
    -   `destroyed`

-   **Vue 3** 选项式 API 中大致相同，两个钩子函数改名：

    -   `beforeCreate`
    -   `created`
    -   `beforeMount`
    -   `mounted`
    -   `beforeUpdate`
    -   `updated`
    -   `beforeUnmount`（原 `beforeDestroy`）
    -   `unmounted`（原 `destroyed`）

-   **Vue 3** 组合式 API 通过导入相应的函数来使用：
    -   `onBeforeMount()`
    -   `onMounted()`
    -   `onBeforeUpdate()`
    -   `onUpdated()`
    -   `onBeforeUnmount()`
    -   `onUnmounted()`

Vue 3 提供了新的组合式 API，使得代码更具模块化和复用性，推荐在复杂的应用中使用这种新的 API 来组织代码。
