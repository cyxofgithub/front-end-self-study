## 是什么

模块联邦是一种在前端应用程序中实现模块共享和远程加载的技术，它提供了一种灵活的方式来组织和共享代码，以实现更好的代码复用和分布式开发

## 与微前端的区别

颗粒化更细，模块联邦能切割到模块，主应用能依赖另一个应用的模块

## 怎么用

### 主应用程序

```javascript
// webpack.config.js

const HtmlWebpackPlugin = require('html-webpack-plugin');
const ModuleFederationPlugin = require('webpack').container.ModuleFederationPlugin;

// 使用 ModuleFederationPlugin 插件来配置模块联邦。我们指定了主应用程序的名称为 'host'，并通过 remotes 选项指定了远程应用程序的名称和远程入口文件的 URL。
module.exports = {
    // ...
    plugins: [
        // ...
        new ModuleFederationPlugin({
            name: 'host',
            remotes: {
                remoteApp: 'remoteApp@http://localhost:3001/remoteEntry.js',
            },
        }),
    ],
};
```

使用远程模块

```javascript
// index.js

import('remoteApp/module')
    .then(module => {
        module.greet('Alice');
    })
    .catch(error => console.error(error));
```

### 远程应用

```javascript
// webpack.config.js

const ModuleFederationPlugin = require('webpack').container.ModuleFederationPlugin;

module.exports = {
    // ...
    plugins: [
        new ModuleFederationPlugin({
            name: 'remoteApp',
            filename: 'remoteEntry.js',
            exposes: {
                './module': './src/module',
            },
        }),
    ],
};

// module.js
export function greet(name) {
    console.log(`Hello, ${name}!`);
}
```

## 原理是什么

## 优缺点

### 优点

-   代码共享：模块联邦允许不同的应用之间共享模块，避免了重复编写相同的代码，提高了代码复用性和开发效率。
-   灵活性：模块联邦使得应用可以被拆分为独立的模块和微前端，每个模块可以独立开发、构建和部署，从而实现更灵活的应用架构。
-   动态加载：模块联邦支持在运行时动态加载远程模块，可以按需加载模块，减少初始加载时间和资源占用。
    缺点：

### 缺点

-   复杂性：模块联邦需要进行额外的配置和处理，涉及到多个应用之间的协调和通信。这增加了项目的复杂性，需要更多的开发和维护工作。
    运行时性能：由于需要在运行时加载远程模块，可能会对应用的性能产生一定的影响。特别是在网络较慢或远程模块较多的情况下，可能会导致加载时间延长。
-   兼容性：模块联邦是一个相对较新的技术，对于旧版本的 Webpack 或其他打包工具可能不兼容。因此，需要确保项目使用的是支持模块联邦的最新版本。

## 思考

如果远程应用中的两个模块引用了相同的依赖，那么主引用引用这两个模块时会不会重复加载依赖？

不会，后面引入的模块会拿缓存。需要注意的是，模块联邦的缓存机制是基于模块的标识符进行的。如果两个模块的依赖虽然内容相同，但标识符不同，那么它们仍然会被视为不同的模块，需要分别加载。

## demo

[demo](https://github.com/module-federation/module-federation-examples)
